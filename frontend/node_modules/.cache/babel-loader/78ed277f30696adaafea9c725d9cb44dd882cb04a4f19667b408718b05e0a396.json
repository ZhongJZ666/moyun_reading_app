{"ast":null,"code":"import { mapState, mapActions } from 'vuex';\nexport default {\n  name: 'MyProfileView',\n  data() {\n    return {\n      form: {\n        username: '',\n        email: '',\n        role: '',\n        mentor: null\n      },\n      rules: {\n        email: [{\n          required: true,\n          message: '请输入邮箱',\n          trigger: 'blur'\n        }, {\n          type: 'email',\n          message: '请输入正确的邮箱格式',\n          trigger: 'blur'\n        }]\n      },\n      loading: false\n    };\n  },\n  computed: {\n    ...mapState('auth', ['user']),\n    roleText() {\n      const roles = {\n        student: '学生',\n        mentor: '导师',\n        admin: '管理员'\n      };\n      return roles[this.form.role] || this.form.role;\n    },\n    roleTagType() {\n      const types = {\n        student: 'success',\n        mentor: 'warning',\n        admin: 'danger'\n      };\n      return types[this.form.role] || '';\n    }\n  },\n  created() {\n    this.initForm();\n  },\n  methods: {\n    ...mapActions('auth', ['updateProfile']),\n    initForm() {\n      this.form = {\n        username: this.user.username,\n        email: this.user.email,\n        role: this.user.role,\n        mentor: this.user.mentor\n      };\n    },\n    async handleSubmit() {\n      try {\n        this.loading = true;\n        await this.$refs.profileForm.validate();\n        await this.updateProfile({\n          email: this.form.email\n        });\n        this.$message.success('资料更新成功！');\n      } catch (error) {\n        this.$message.error(error.message);\n      } finally {\n        this.loading = false;\n      }\n    }\n  }\n};","map":{"version":3,"names":["mapState","mapActions","name","data","form","username","email","role","mentor","rules","required","message","trigger","type","loading","computed","roleText","roles","student","admin","roleTagType","types","created","initForm","methods","user","handleSubmit","$refs","profileForm","validate","updateProfile","$message","success","error"],"sources":["E:\\moyun-reading-platform\\moyun-reading-platform\\frontend\\src\\views\\profile\\MyProfile.vue"],"sourcesContent":["<template>\r\n    <div class=\"profile-container\">\r\n      <h2>个人资料</h2>\r\n      <el-divider />\r\n      \r\n      <el-form \r\n        :model=\"form\" \r\n        :rules=\"rules\" \r\n        ref=\"profileForm\"\r\n        label-width=\"100px\"\r\n        @submit.native.prevent=\"handleSubmit\"\r\n      >\r\n        <el-form-item label=\"用户名\">\r\n          <el-input v-model=\"form.username\" disabled />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"邮箱\" prop=\"email\">\r\n          <el-input v-model=\"form.email\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"角色\">\r\n          <el-tag :type=\"roleTagType\">\r\n            {{ roleText }}\r\n          </el-tag>\r\n        </el-form-item>\r\n        \r\n        <el-form-item \r\n          label=\"导师\" \r\n          v-if=\"form.role === 'student' && form.mentor\"\r\n        >\r\n          <el-tag>{{ form.mentor.username }}</el-tag>\r\n        </el-form-item>\r\n        \r\n        <el-form-item>\r\n          <el-button \r\n            type=\"primary\" \r\n            native-type=\"submit\"\r\n            :loading=\"loading\"\r\n          >\r\n            保存修改\r\n          </el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import { mapState, mapActions } from 'vuex'\r\n  \r\n  export default {\r\n    name: 'MyProfileView',\r\n    data() {\r\n      return {\r\n        form: {\r\n          username: '',\r\n          email: '',\r\n          role: '',\r\n          mentor: null\r\n        },\r\n        rules: {\r\n          email: [\r\n            { required: true, message: '请输入邮箱', trigger: 'blur' },\r\n            { type: 'email', message: '请输入正确的邮箱格式', trigger: 'blur' }\r\n          ]\r\n        },\r\n        loading: false\r\n      }\r\n    },\r\n    computed: {\r\n      ...mapState('auth', ['user']),\r\n      roleText() {\r\n        const roles = {\r\n          student: '学生',\r\n          mentor: '导师',\r\n          admin: '管理员'\r\n        }\r\n        return roles[this.form.role] || this.form.role\r\n      },\r\n      roleTagType() {\r\n        const types = {\r\n          student: 'success',\r\n          mentor: 'warning',\r\n          admin: 'danger'\r\n        }\r\n        return types[this.form.role] || ''\r\n      }\r\n    },\r\n    created() {\r\n      this.initForm()\r\n    },\r\n    methods: {\r\n      ...mapActions('auth', ['updateProfile']),\r\n      initForm() {\r\n        this.form = {\r\n          username: this.user.username,\r\n          email: this.user.email,\r\n          role: this.user.role,\r\n          mentor: this.user.mentor\r\n        }\r\n      },\r\n      async handleSubmit() {\r\n        try {\r\n          this.loading = true\r\n          await this.$refs.profileForm.validate()\r\n          await this.updateProfile({\r\n            email: this.form.email\r\n          })\r\n          this.$message.success('资料更新成功！')\r\n        } catch (error) {\r\n          this.$message.error(error.message)\r\n        } finally {\r\n          this.loading = false\r\n        }\r\n      }\r\n    }\r\n  }\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .profile-container {\r\n    padding: 20px;\r\n    max-width: 600px;\r\n    margin: 0 auto;\r\n  }\r\n  </style>"],"mappings":"AA+CE,SAASA,QAAQ,EAAEC,UAAS,QAAS,MAAK;AAE1C,eAAe;EACbC,IAAI,EAAE,eAAe;EACrBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,IAAI,EAAE;QACJC,QAAQ,EAAE,EAAE;QACZC,KAAK,EAAE,EAAE;QACTC,IAAI,EAAE,EAAE;QACRC,MAAM,EAAE;MACV,CAAC;MACDC,KAAK,EAAE;QACLH,KAAK,EAAE,CACL;UAAEI,QAAQ,EAAE,IAAI;UAAEC,OAAO,EAAE,OAAO;UAAEC,OAAO,EAAE;QAAO,CAAC,EACrD;UAAEC,IAAI,EAAE,OAAO;UAAEF,OAAO,EAAE,YAAY;UAAEC,OAAO,EAAE;QAAO;MAE5D,CAAC;MACDE,OAAO,EAAE;IACX;EACF,CAAC;EACDC,QAAQ,EAAE;IACR,GAAGf,QAAQ,CAAC,MAAM,EAAE,CAAC,MAAM,CAAC,CAAC;IAC7BgB,QAAQA,CAAA,EAAG;MACT,MAAMC,KAAI,GAAI;QACZC,OAAO,EAAE,IAAI;QACbV,MAAM,EAAE,IAAI;QACZW,KAAK,EAAE;MACT;MACA,OAAOF,KAAK,CAAC,IAAI,CAACb,IAAI,CAACG,IAAI,KAAK,IAAI,CAACH,IAAI,CAACG,IAAG;IAC/C,CAAC;IACDa,WAAWA,CAAA,EAAG;MACZ,MAAMC,KAAI,GAAI;QACZH,OAAO,EAAE,SAAS;QAClBV,MAAM,EAAE,SAAS;QACjBW,KAAK,EAAE;MACT;MACA,OAAOE,KAAK,CAAC,IAAI,CAACjB,IAAI,CAACG,IAAI,KAAK,EAAC;IACnC;EACF,CAAC;EACDe,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,QAAQ,CAAC;EAChB,CAAC;EACDC,OAAO,EAAE;IACP,GAAGvB,UAAU,CAAC,MAAM,EAAE,CAAC,eAAe,CAAC,CAAC;IACxCsB,QAAQA,CAAA,EAAG;MACT,IAAI,CAACnB,IAAG,GAAI;QACVC,QAAQ,EAAE,IAAI,CAACoB,IAAI,CAACpB,QAAQ;QAC5BC,KAAK,EAAE,IAAI,CAACmB,IAAI,CAACnB,KAAK;QACtBC,IAAI,EAAE,IAAI,CAACkB,IAAI,CAAClB,IAAI;QACpBC,MAAM,EAAE,IAAI,CAACiB,IAAI,CAACjB;MACpB;IACF,CAAC;IACD,MAAMkB,YAAYA,CAAA,EAAG;MACnB,IAAI;QACF,IAAI,CAACZ,OAAM,GAAI,IAAG;QAClB,MAAM,IAAI,CAACa,KAAK,CAACC,WAAW,CAACC,QAAQ,CAAC;QACtC,MAAM,IAAI,CAACC,aAAa,CAAC;UACvBxB,KAAK,EAAE,IAAI,CAACF,IAAI,CAACE;QACnB,CAAC;QACD,IAAI,CAACyB,QAAQ,CAACC,OAAO,CAAC,SAAS;MACjC,EAAE,OAAOC,KAAK,EAAE;QACd,IAAI,CAACF,QAAQ,CAACE,KAAK,CAACA,KAAK,CAACtB,OAAO;MACnC,UAAU;QACR,IAAI,CAACG,OAAM,GAAI,KAAI;MACrB;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}