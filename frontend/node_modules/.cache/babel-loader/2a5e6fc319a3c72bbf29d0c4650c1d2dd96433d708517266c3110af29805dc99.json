{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"login-container\"\n};\nconst _hoisted_2 = {\n  class: \"footer\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  const _component_router_link = _resolveComponent(\"router-link\");\n  const _component_el_card = _resolveComponent(\"el-card\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_el_card, {\n    class: \"login-card\"\n  }, {\n    default: _withCtx(() => [_cache[4] || (_cache[4] = _createElementVNode(\"h2\", null, \"墨韵读书会登录\", -1 /* HOISTED */)), _createVNode(_component_el_form, {\n      model: $data.form,\n      rules: $data.rules,\n      ref: \"loginForm\",\n      onSubmit: _withModifiers($options.handleLogin, [\"prevent\"])\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_form_item, {\n        prop: \"username\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: $data.form.username,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.form.username = $event),\n          placeholder: \"请输入用户名\",\n          \"prefix-icon\": \"el-icon-user\"\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        prop: \"password\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: $data.form.password,\n          \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.form.password = $event),\n          type: \"password\",\n          placeholder: \"请输入密码\",\n          \"prefix-icon\": \"el-icon-lock\",\n          \"show-password\": \"\"\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, null, {\n        default: _withCtx(() => [_createVNode(_component_el_button, {\n          type: \"primary\",\n          \"native-type\": \"submit\",\n          loading: $data.loading,\n          class: \"login-btn\"\n        }, {\n          default: _withCtx(() => _cache[2] || (_cache[2] = [_createTextVNode(\" 登录 \")])),\n          _: 1 /* STABLE */,\n          __: [2]\n        }, 8 /* PROPS */, [\"loading\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"model\", \"rules\", \"onSubmit\"]), _createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_router_link, {\n      to: \"/register\"\n    }, {\n      default: _withCtx(() => _cache[3] || (_cache[3] = [_createTextVNode(\"注册账号\")])),\n      _: 1 /* STABLE */,\n      __: [3]\n    })])]),\n    _: 1 /* STABLE */,\n    __: [4]\n  })]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_el_card","default","_withCtx","_createElementVNode","_component_el_form","model","$data","form","rules","ref","onSubmit","_withModifiers","$options","handleLogin","_component_el_form_item","prop","_component_el_input","modelValue","username","_cache","$event","placeholder","_","password","type","_component_el_button","loading","_createTextVNode","__","_hoisted_2","_component_router_link","to"],"sources":["E:\\moyun-reading-platform\\frontend\\src\\views\\auth\\Login.vue"],"sourcesContent":["<template>\r\n    <div class=\"login-container\">\r\n      <el-card class=\"login-card\">\r\n        <h2>墨韵读书会登录</h2>\r\n        <el-form \r\n          :model=\"form\" \r\n          :rules=\"rules\" \r\n          ref=\"loginForm\"\r\n          @submit.native.prevent=\"handleLogin\"\r\n        >\r\n          <el-form-item prop=\"username\">\r\n            <el-input\r\n              v-model=\"form.username\"\r\n              placeholder=\"请输入用户名\"\r\n              prefix-icon=\"el-icon-user\"\r\n            />\r\n          </el-form-item>\r\n          <el-form-item prop=\"password\">\r\n            <el-input\r\n              v-model=\"form.password\"\r\n              type=\"password\"\r\n              placeholder=\"请输入密码\"\r\n              prefix-icon=\"el-icon-lock\"\r\n              show-password\r\n            />\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button \r\n              type=\"primary\" \r\n              native-type=\"submit\"\r\n              :loading=\"loading\"\r\n              class=\"login-btn\"\r\n            >\r\n              登录\r\n            </el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div class=\"footer\">\r\n          <router-link to=\"/register\">注册账号</router-link>\r\n        </div>\r\n      </el-card>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import { mapActions } from 'vuex'\r\n  \r\n  export default {\r\n    name: 'LoginView',\r\n    data() {\r\n      return {\r\n        form: {\r\n          username: '',\r\n          password: ''\r\n        },\r\n        rules: {\r\n          username: [\r\n            { required: true, message: '请输入用户名', trigger: 'blur' }\r\n          ],\r\n          password: [\r\n            { required: true, message: '请输入密码', trigger: 'blur' }\r\n          ]\r\n        },\r\n        loading: false\r\n      }\r\n    },\r\n    methods: {\r\n      ...mapActions('auth', ['login']),\r\n      async handleLogin() {\r\n        try {\r\n          this.loading = true\r\n          await this.$refs.loginForm.validate()\r\n          const user = await this.login(this.form)\r\n          console.log('登录成功，用户信息:', user)\r\n          \r\n          // 根据用户角色决定跳转路径\r\n          let redirectPath = '/'\r\n          if (user.role === 'admin') {\r\n            redirectPath = '/admin'\r\n          } else if (user.role === 'mentor') {\r\n            redirectPath = '/mentor'\r\n          } else if (user.role === 'student') {\r\n            redirectPath = '/student'\r\n          }\r\n          \r\n          console.log('准备跳转到:', redirectPath)\r\n          await this.$router.push(redirectPath)\r\n          this.$message.success('登录成功')\r\n        } catch (error) {\r\n          console.error('登录失败:', error)\r\n          this.$message.error(error.message || '登录失败')\r\n        } finally {\r\n          this.loading = false\r\n        }\r\n      }\r\n    }\r\n  }\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .login-container {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    height: 100vh;\r\n    background: #f5f7fa;\r\n  }\r\n  \r\n  .login-card {\r\n    width: 400px;\r\n    padding: 20px;\r\n  }\r\n  \r\n  h2 {\r\n    text-align: center;\r\n    margin-bottom: 30px;\r\n    color: #333;\r\n  }\r\n  \r\n  .login-btn {\r\n    width: 100%;\r\n  }\r\n  \r\n  .footer {\r\n    text-align: center;\r\n    margin-top: 20px;\r\n    font-size: 14px;\r\n  }\r\n  </style>"],"mappings":";;EACSA,KAAK,EAAC;AAAiB;;EAoCnBA,KAAK,EAAC;AAAQ;;;;;;;;uBApCvBC,mBAAA,CAwCM,OAxCNC,UAwCM,GAvCJC,YAAA,CAsCUC,kBAAA;IAtCDJ,KAAK,EAAC;EAAY;IAFjCK,OAAA,EAAAC,QAAA,CAGQ,MAAgB,C,0BAAhBC,mBAAA,CAAgB,YAAZ,SAAO,sBACXJ,YAAA,CAgCUK,kBAAA;MA/BPC,KAAK,EAAEC,KAAA,CAAAC,IAAI;MACXC,KAAK,EAAEF,KAAA,CAAAE,KAAK;MACbC,GAAG,EAAC,WAAW;MACdC,QAAM,EARjBC,cAAA,CAQkCC,QAAA,CAAAC,WAAW;;MAR7CZ,OAAA,EAAAC,QAAA,CAUU,MAMe,CANfH,YAAA,CAMee,uBAAA;QANDC,IAAI,EAAC;MAAU;QAVvCd,OAAA,EAAAC,QAAA,CAWY,MAIE,CAJFH,YAAA,CAIEiB,mBAAA;UAfdC,UAAA,EAYuBX,KAAA,CAAAC,IAAI,CAACW,QAAQ;UAZpC,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAYuBd,KAAA,CAAAC,IAAI,CAACW,QAAQ,GAAAE,MAAA;UACtBC,WAAW,EAAC,QAAQ;UACpB,aAAW,EAAC;;QAd1BC,CAAA;UAiBUvB,YAAA,CAQee,uBAAA;QARDC,IAAI,EAAC;MAAU;QAjBvCd,OAAA,EAAAC,QAAA,CAkBY,MAME,CANFH,YAAA,CAMEiB,mBAAA;UAxBdC,UAAA,EAmBuBX,KAAA,CAAAC,IAAI,CAACgB,QAAQ;UAnBpC,uBAAAJ,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAmBuBd,KAAA,CAAAC,IAAI,CAACgB,QAAQ,GAAAH,MAAA;UACtBI,IAAI,EAAC,UAAU;UACfH,WAAW,EAAC,OAAO;UACnB,aAAW,EAAC,cAAc;UAC1B,eAAa,EAAb;;QAvBdC,CAAA;UA0BUvB,YAAA,CASee,uBAAA;QAnCzBb,OAAA,EAAAC,QAAA,CA2BY,MAOY,CAPZH,YAAA,CAOY0B,oBAAA;UANVD,IAAI,EAAC,SAAS;UACd,aAAW,EAAC,QAAQ;UACnBE,OAAO,EAAEpB,KAAA,CAAAoB,OAAO;UACjB9B,KAAK,EAAC;;UA/BpBK,OAAA,EAAAC,QAAA,CAgCa,MAEDiB,MAAA,QAAAA,MAAA,OAlCZQ,gBAAA,CAgCa,MAED,E;UAlCZL,CAAA;UAAAM,EAAA;;QAAAN,CAAA;;MAAAA,CAAA;uDAqCQnB,mBAAA,CAEM,OAFN0B,UAEM,GADJ9B,YAAA,CAA8C+B,sBAAA;MAAjCC,EAAE,EAAC;IAAW;MAtCrC9B,OAAA,EAAAC,QAAA,CAsCsC,MAAIiB,MAAA,QAAAA,MAAA,OAtC1CQ,gBAAA,CAsCsC,MAAI,E;MAtC1CL,CAAA;MAAAM,EAAA;;IAAAN,CAAA;IAAAM,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}