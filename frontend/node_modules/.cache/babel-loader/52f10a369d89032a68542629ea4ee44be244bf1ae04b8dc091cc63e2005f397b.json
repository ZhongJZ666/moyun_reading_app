{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapActions } from 'vuex';\nexport default {\n  name: 'CreatePostView',\n  data() {\n    return {\n      form: {\n        title: '',\n        content: '',\n        circleId: null,\n        bookId: null\n      },\n      rules: {\n        title: [{\n          required: true,\n          message: '请输入标题',\n          trigger: 'blur'\n        }, {\n          min: 5,\n          max: 100,\n          message: '长度在5到100个字符',\n          trigger: 'blur'\n        }],\n        content: [{\n          required: true,\n          message: '请输入内容',\n          trigger: 'blur'\n        }, {\n          min: 10,\n          message: '内容至少10个字符',\n          trigger: 'blur'\n        }]\n      },\n      loading: false\n    };\n  },\n  created() {\n    this.form.circleId = this.$route.query.circleId;\n    this.form.bookId = this.$route.query.bookId;\n  },\n  methods: {\n    ...mapActions('posts', ['createPost']),\n    async handleSubmit() {\n      try {\n        this.loading = true;\n        await this.$refs.postForm.validate();\n        const newPost = await this.createPost(this.form);\n        this.$message.success('发布成功！');\n\n        // 根据来源跳转不同页面\n        if (this.form.bookId) {\n          this.$router.push(`/books/${this.form.bookId}`);\n        } else if (this.form.circleId) {\n          this.$router.push(`/my-circle`);\n        } else {\n          this.$router.push('/');\n        }\n      } catch (error) {\n        this.$message.error(error.message);\n      } finally {\n        this.loading = false;\n      }\n    }\n  }\n};","map":{"version":3,"names":["mapActions","name","data","form","title","content","circleId","bookId","rules","required","message","trigger","min","max","loading","created","$route","query","methods","handleSubmit","$refs","postForm","validate","newPost","createPost","$message","success","$router","push","error"],"sources":["E:\\moyun-reading-platform\\moyun-reading-platform\\frontend\\src\\views\\posts\\CreatePost.vue"],"sourcesContent":["<template>\r\n    <div class=\"create-post-container\">\r\n      <h2>发表读后感</h2>\r\n      <el-divider />\r\n      \r\n      <el-form \r\n        :model=\"form\" \r\n        :rules=\"rules\" \r\n        ref=\"postForm\"\r\n        @submit.native.prevent=\"handleSubmit\"\r\n      >\r\n        <el-form-item prop=\"title\">\r\n          <el-input\r\n            v-model=\"form.title\"\r\n            placeholder=\"标题\"\r\n            maxlength=\"100\"\r\n            show-word-limit\r\n          />\r\n        </el-form-item>\r\n        \r\n        <el-form-item prop=\"content\">\r\n          <el-input\r\n            v-model=\"form.content\"\r\n            type=\"textarea\"\r\n            :rows=\"10\"\r\n            placeholder=\"写下你的读后感...\"\r\n          />\r\n        </el-form-item>\r\n        \r\n        <el-form-item>\r\n          <el-button \r\n            type=\"primary\" \r\n            native-type=\"submit\"\r\n            :loading=\"loading\"\r\n          >\r\n            发布\r\n          </el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import { mapActions } from 'vuex'\r\n  \r\n  export default {\r\n    name: 'CreatePostView',\r\n    data() {\r\n      return {\r\n        form: {\r\n          title: '',\r\n          content: '',\r\n          circleId: null,\r\n          bookId: null\r\n        },\r\n        rules: {\r\n          title: [\r\n            { required: true, message: '请输入标题', trigger: 'blur' },\r\n            { min: 5, max: 100, message: '长度在5到100个字符', trigger: 'blur' }\r\n          ],\r\n          content: [\r\n            { required: true, message: '请输入内容', trigger: 'blur' },\r\n            { min: 10, message: '内容至少10个字符', trigger: 'blur' }\r\n          ]\r\n        },\r\n        loading: false\r\n      }\r\n    },\r\n    created() {\r\n      this.form.circleId = this.$route.query.circleId\r\n      this.form.bookId = this.$route.query.bookId\r\n    },\r\n    methods: {\r\n      ...mapActions('posts', ['createPost']),\r\n      async handleSubmit() {\r\n        try {\r\n          this.loading = true\r\n          await this.$refs.postForm.validate()\r\n          const newPost = await this.createPost(this.form)\r\n          this.$message.success('发布成功！')\r\n          \r\n          // 根据来源跳转不同页面\r\n          if (this.form.bookId) {\r\n            this.$router.push(`/books/${this.form.bookId}`)\r\n          } else if (this.form.circleId) {\r\n            this.$router.push(`/my-circle`)\r\n          } else {\r\n            this.$router.push('/')\r\n          }\r\n        } catch (error) {\r\n          this.$message.error(error.message)\r\n        } finally {\r\n          this.loading = false\r\n        }\r\n      }\r\n    }\r\n  }\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .create-post-container {\r\n    padding: 20px;\r\n    max-width: 800px;\r\n    margin: 0 auto;\r\n  }\r\n  </style>"],"mappings":";AA2CE,SAASA,UAAS,QAAS,MAAK;AAEhC,eAAe;EACbC,IAAI,EAAE,gBAAgB;EACtBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,IAAI,EAAE;QACJC,KAAK,EAAE,EAAE;QACTC,OAAO,EAAE,EAAE;QACXC,QAAQ,EAAE,IAAI;QACdC,MAAM,EAAE;MACV,CAAC;MACDC,KAAK,EAAE;QACLJ,KAAK,EAAE,CACL;UAAEK,QAAQ,EAAE,IAAI;UAAEC,OAAO,EAAE,OAAO;UAAEC,OAAO,EAAE;QAAO,CAAC,EACrD;UAAEC,GAAG,EAAE,CAAC;UAAEC,GAAG,EAAE,GAAG;UAAEH,OAAO,EAAE,aAAa;UAAEC,OAAO,EAAE;QAAO,EAC7D;QACDN,OAAO,EAAE,CACP;UAAEI,QAAQ,EAAE,IAAI;UAAEC,OAAO,EAAE,OAAO;UAAEC,OAAO,EAAE;QAAO,CAAC,EACrD;UAAEC,GAAG,EAAE,EAAE;UAAEF,OAAO,EAAE,WAAW;UAAEC,OAAO,EAAE;QAAO;MAErD,CAAC;MACDG,OAAO,EAAE;IACX;EACF,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACZ,IAAI,CAACG,QAAO,GAAI,IAAI,CAACU,MAAM,CAACC,KAAK,CAACX,QAAO;IAC9C,IAAI,CAACH,IAAI,CAACI,MAAK,GAAI,IAAI,CAACS,MAAM,CAACC,KAAK,CAACV,MAAK;EAC5C,CAAC;EACDW,OAAO,EAAE;IACP,GAAGlB,UAAU,CAAC,OAAO,EAAE,CAAC,YAAY,CAAC,CAAC;IACtC,MAAMmB,YAAYA,CAAA,EAAG;MACnB,IAAI;QACF,IAAI,CAACL,OAAM,GAAI,IAAG;QAClB,MAAM,IAAI,CAACM,KAAK,CAACC,QAAQ,CAACC,QAAQ,CAAC;QACnC,MAAMC,OAAM,GAAI,MAAM,IAAI,CAACC,UAAU,CAAC,IAAI,CAACrB,IAAI;QAC/C,IAAI,CAACsB,QAAQ,CAACC,OAAO,CAAC,OAAO;;QAE7B;QACA,IAAI,IAAI,CAACvB,IAAI,CAACI,MAAM,EAAE;UACpB,IAAI,CAACoB,OAAO,CAACC,IAAI,CAAC,UAAU,IAAI,CAACzB,IAAI,CAACI,MAAM,EAAE;QAChD,OAAO,IAAI,IAAI,CAACJ,IAAI,CAACG,QAAQ,EAAE;UAC7B,IAAI,CAACqB,OAAO,CAACC,IAAI,CAAC,YAAY;QAChC,OAAO;UACL,IAAI,CAACD,OAAO,CAACC,IAAI,CAAC,GAAG;QACvB;MACF,EAAE,OAAOC,KAAK,EAAE;QACd,IAAI,CAACJ,QAAQ,CAACI,KAAK,CAACA,KAAK,CAACnB,OAAO;MACnC,UAAU;QACR,IAAI,CAACI,OAAM,GAAI,KAAI;MACrB;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}