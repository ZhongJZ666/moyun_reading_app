{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, Fragment as _Fragment, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"circle-container\"\n};\nconst _hoisted_2 = {\n  class: \"post-area\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_circle_sidebar = _resolveComponent(\"circle-sidebar\");\n  const _component_el_col = _resolveComponent(\"el-col\");\n  const _component_create_post_form = _resolveComponent(\"create-post-form\");\n  const _component_post_list = _resolveComponent(\"post-list\");\n  const _component_el_row = _resolveComponent(\"el-row\");\n  const _component_add_member_form = _resolveComponent(\"add-member-form\");\n  const _component_el_dialog = _resolveComponent(\"el-dialog\");\n  const _component_el_empty = _resolveComponent(\"el-empty\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_ctx.circle && _ctx.circle.id ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 0\n  }, [_createVNode(_component_el_row, {\n    gutter: 20\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_col, {\n      span: 6\n    }, {\n      default: _withCtx(() => [_createVNode(_component_circle_sidebar, {\n        circle: _ctx.circle,\n        members: _ctx.members,\n        onAddMember: _cache[0] || (_cache[0] = $event => $data.showAddMemberDialog = true)\n      }, null, 8 /* PROPS */, [\"circle\", \"members\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_col, {\n      span: 18\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_2, [$options.isMember ? (_openBlock(), _createBlock(_component_create_post_form, {\n        key: 0,\n        \"circle-id\": _ctx.circle.id,\n        onCreated: $options.handlePostCreated\n      }, null, 8 /* PROPS */, [\"circle-id\", \"onCreated\"])) : _createCommentVNode(\"v-if\", true), _createVNode(_component_post_list, {\n        posts: _ctx.posts,\n        loading: _ctx.loading,\n        onLoadMore: $options.loadMorePosts\n      }, null, 8 /* PROPS */, [\"posts\", \"loading\", \"onLoadMore\"])])]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_el_dialog, {\n    title: \"添加成员\",\n    modelValue: $data.showAddMemberDialog,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.showAddMemberDialog = $event),\n    width: \"30%\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_add_member_form, {\n      \"circle-id\": _ctx.circle.id,\n      onSuccess: $options.handleMemberAdded\n    }, null, 8 /* PROPS */, [\"circle-id\", \"onSuccess\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"])], 64 /* STABLE_FRAGMENT */)) : (_openBlock(), _createBlock(_component_el_empty, {\n    key: 1,\n    description: \"你还没有加入任何圈子\"\n  }))]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_ctx","circle","id","_Fragment","key","_createVNode","_component_el_row","gutter","default","_withCtx","_component_el_col","span","_component_circle_sidebar","members","onAddMember","_cache","$event","$data","showAddMemberDialog","_","_createElementVNode","_hoisted_2","$options","isMember","_createBlock","_component_create_post_form","onCreated","handlePostCreated","_createCommentVNode","_component_post_list","posts","loading","onLoadMore","loadMorePosts","_component_el_dialog","title","modelValue","width","_component_add_member_form","onSuccess","handleMemberAdded","_component_el_empty","description"],"sources":["C:\\Users\\仲佳泽\\Desktop\\大学作业\\软件工程\\moyun-reading-platform\\frontend\\src\\views\\circles\\MyCircle.vue"],"sourcesContent":["<template>\r\n    <div class=\"circle-container\">\r\n      <template v-if=\"circle && circle.id\">\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"6\">\r\n            <circle-sidebar \r\n              :circle=\"circle\" \r\n              :members=\"members\"\r\n              @add-member=\"showAddMemberDialog = true\"\r\n            />\r\n          </el-col>\r\n          <el-col :span=\"18\">\r\n            <div class=\"post-area\">\r\n              <create-post-form \r\n                v-if=\"isMember\"\r\n                :circle-id=\"circle.id\"\r\n                @created=\"handlePostCreated\"\r\n              />\r\n              \r\n              <post-list \r\n                :posts=\"posts\" \r\n                :loading=\"loading\"\r\n                @load-more=\"loadMorePosts\"\r\n              />\r\n            </div>\r\n          </el-col>\r\n        </el-row>\r\n    \r\n        <el-dialog \r\n          title=\"添加成员\" \r\n          v-model=\"showAddMemberDialog\"\r\n          width=\"30%\"\r\n        >\r\n          <add-member-form \r\n            :circle-id=\"circle.id\"\r\n            @success=\"handleMemberAdded\"\r\n          />\r\n        </el-dialog>\r\n      </template>\r\n      <template v-else>\r\n        <el-empty description=\"你还没有加入任何圈子\" />\r\n      </template>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import { mapState, mapGetters, mapActions } from 'vuex'\r\n  import CircleSidebar from '@/components/CircleSidebar.vue'\r\n  import CreatePostForm from '@/components/CreatePostForm.vue'\r\n  import PostList from '@/components/PostList.vue'\r\n  import AddMemberForm from '@/components/AddMemberForm.vue'\r\n  \r\n  export default {\r\n    name: 'MyCircleView',\r\n    components: {\r\n      CircleSidebar,\r\n      CreatePostForm,\r\n      PostList,\r\n      AddMemberForm\r\n    },\r\n    data() {\r\n      return {\r\n        showAddMemberDialog: false,\r\n        page: 1,\r\n        pageSize: 10\r\n      }\r\n    },\r\n    computed: {\r\n      ...mapState('circles', ['circle', 'members', 'loading']),\r\n      ...mapState('posts', ['posts']),\r\n      ...mapGetters('auth', ['isMentor', 'currentUser']),\r\n      isMember() {\r\n        return this.members.some(m => m.id === this.currentUser.id)\r\n      }\r\n    },\r\n    async created() {\r\n      await this.fetchCircleData()\r\n    },\r\n    methods: {\r\n      ...mapActions('circles', ['fetchMyCircle']),\r\n      ...mapActions('posts', ['fetchCirclePosts']),\r\n      async fetchCircleData() {\r\n        await this.fetchMyCircle()\r\n        if (this.circle?.id) {\r\n          await this.fetchCirclePosts({\r\n            circleId: this.circle.id,\r\n            page: this.page,\r\n            pageSize: this.pageSize\r\n          })\r\n        }\r\n      },\r\n      handlePostCreated(newPost) {\r\n        this.posts.unshift(newPost)\r\n      },\r\n      handleMemberAdded() {\r\n        this.showAddMemberDialog = false\r\n        this.fetchCircleData()\r\n      },\r\n      async loadMorePosts() {\r\n        this.page++\r\n        await this.fetchCirclePosts({\r\n          circleId: this.circle.id,\r\n          page: this.page,\r\n          pageSize: this.pageSize\r\n        })\r\n      }\r\n    }\r\n  }\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .circle-container {\r\n    padding: 20px;\r\n    max-width: 1200px;\r\n    margin: 0 auto;\r\n  }\r\n  \r\n  .post-area {\r\n    padding: 0 20px;\r\n  }\r\n  </style>"],"mappings":";;EACSA,KAAK,EAAC;AAAkB;;EAWhBA,KAAK,EAAC;AAAW;;;;;;;;;;uBAX9BC,mBAAA,CAyCM,OAzCNC,UAyCM,GAxCYC,IAAA,CAAAC,MAAM,IAAID,IAAA,CAAAC,MAAM,CAACC,EAAE,I,cAAnCJ,mBAAA,CAoCWK,SAAA;IAtCjBC,GAAA;EAAA,IAGQC,YAAA,CAuBSC,iBAAA;IAvBAC,MAAM,EAAE;EAAE;IAH3BC,OAAA,EAAAC,QAAA,CAIU,MAMS,CANTJ,YAAA,CAMSK,iBAAA;MANAC,IAAI,EAAE;IAAC;MAJ1BH,OAAA,EAAAC,QAAA,CAKY,MAIE,CAJFJ,YAAA,CAIEO,yBAAA;QAHCX,MAAM,EAAED,IAAA,CAAAC,MAAM;QACdY,OAAO,EAAEb,IAAA,CAAAa,OAAO;QAChBC,WAAU,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEC,KAAA,CAAAC,mBAAmB;;MAR9CC,CAAA;QAWUd,YAAA,CAcSK,iBAAA;MAdAC,IAAI,EAAE;IAAE;MAX3BH,OAAA,EAAAC,QAAA,CAYY,MAYM,CAZNW,mBAAA,CAYM,OAZNC,UAYM,GAVIC,QAAA,CAAAC,QAAQ,I,cADhBC,YAAA,CAIEC,2BAAA;QAjBhBrB,GAAA;QAeiB,WAAS,EAAEJ,IAAA,CAAAC,MAAM,CAACC,EAAE;QACpBwB,SAAO,EAAEJ,QAAA,CAAAK;6DAhB1BC,mBAAA,gBAmBcvB,YAAA,CAIEwB,oBAAA;QAHCC,KAAK,EAAE9B,IAAA,CAAA8B,KAAK;QACZC,OAAO,EAAE/B,IAAA,CAAA+B,OAAO;QAChBC,UAAS,EAAEV,QAAA,CAAAW;;MAtB5Bd,CAAA;;IAAAA,CAAA;MA4BQd,YAAA,CASY6B,oBAAA;IARVC,KAAK,EAAC,MAAM;IA7BtBC,UAAA,EA8BmBnB,KAAA,CAAAC,mBAAmB;IA9BtC,uBAAAH,MAAA,QAAAA,MAAA,MAAAC,MAAA,IA8BmBC,KAAA,CAAAC,mBAAmB,GAAAF,MAAA;IAC5BqB,KAAK,EAAC;;IA/BhB7B,OAAA,EAAAC,QAAA,CAiCU,MAGE,CAHFJ,YAAA,CAGEiC,0BAAA;MAFC,WAAS,EAAEtC,IAAA,CAAAC,MAAM,CAACC,EAAE;MACpBqC,SAAO,EAAEjB,QAAA,CAAAkB;;IAnCtBrB,CAAA;kFAwCQK,YAAA,CAAqCiB,mBAAA;IAxC7CrC,GAAA;IAwCkBsC,WAAW,EAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}