{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport { mapState, mapGetters, mapActions } from 'vuex';\nimport CircleSidebar from '@/components/CircleSidebar.vue';\nimport CreatePostForm from '@/components/CreatePostForm.vue';\nimport PostList from '@/components/PostList.vue';\nimport AddMemberForm from '@/components/AddMemberForm.vue';\nexport default {\n  name: 'MyCircleView',\n  components: {\n    CircleSidebar,\n    CreatePostForm,\n    PostList,\n    AddMemberForm\n  },\n  data() {\n    return {\n      showAddMemberDialog: false,\n      page: 1,\n      pageSize: 10\n    };\n  },\n  computed: {\n    ...mapState('circles', ['circle', 'members', 'loading']),\n    ...mapState('posts', ['posts']),\n    ...mapGetters('auth', ['isMentor', 'currentUser']),\n    isMember() {\n      return this.members.some(m => m.id === this.currentUser.id);\n    }\n  },\n  async created() {\n    await this.fetchCircleData();\n  },\n  methods: {\n    ...mapActions('circles', ['fetchMyCircle']),\n    ...mapActions('posts', ['fetchCirclePosts']),\n    async fetchCircleData() {\n      await this.fetchMyCircle();\n      if (this.circle?.id) {\n        await this.fetchCirclePosts({\n          circleId: this.circle.id,\n          page: this.page,\n          pageSize: this.pageSize\n        });\n      }\n    },\n    handlePostCreated(newPost) {\n      this.posts.unshift(newPost);\n    },\n    handleMemberAdded() {\n      this.showAddMemberDialog = false;\n      this.fetchCircleData();\n    },\n    async loadMorePosts() {\n      this.page++;\n      await this.fetchCirclePosts({\n        circleId: this.circle.id,\n        page: this.page,\n        pageSize: this.pageSize\n      });\n    }\n  }\n};","map":{"version":3,"names":["mapState","mapGetters","mapActions","CircleSidebar","CreatePostForm","PostList","AddMemberForm","name","components","data","showAddMemberDialog","page","pageSize","computed","isMember","members","some","m","id","currentUser","created","fetchCircleData","methods","fetchMyCircle","circle","fetchCirclePosts","circleId","handlePostCreated","newPost","posts","unshift","handleMemberAdded","loadMorePosts"],"sources":["C:\\Users\\仲佳泽\\Desktop\\大学作业\\软件工程\\moyun-reading-platform\\frontend\\src\\views\\circles\\MyCircle.vue"],"sourcesContent":["<template>\r\n    <div class=\"circle-container\">\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"6\">\r\n          <circle-sidebar \r\n            :circle=\"circle\" \r\n            :members=\"members\"\r\n            @add-member=\"showAddMemberDialog = true\"\r\n          />\r\n        </el-col>\r\n        <el-col :span=\"18\">\r\n          <div class=\"post-area\">\r\n            <create-post-form \r\n              v-if=\"isMember\"\r\n              :circle-id=\"circle.id\"\r\n              @created=\"handlePostCreated\"\r\n            />\r\n            \r\n            <post-list \r\n              :posts=\"posts\" \r\n              :loading=\"loading\"\r\n              @load-more=\"loadMorePosts\"\r\n            />\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n  \r\n      <el-dialog \r\n        title=\"添加成员\" \r\n        v-model=\"showAddMemberDialog\"\r\n        width=\"30%\"\r\n      >\r\n        <add-member-form \r\n          :circle-id=\"circle.id\"\r\n          @success=\"handleMemberAdded\"\r\n        />\r\n      </el-dialog>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import { mapState, mapGetters, mapActions } from 'vuex'\r\n  import CircleSidebar from '@/components/CircleSidebar.vue'\r\n  import CreatePostForm from '@/components/CreatePostForm.vue'\r\n  import PostList from '@/components/PostList.vue'\r\n  import AddMemberForm from '@/components/AddMemberForm.vue'\r\n  \r\n  export default {\r\n    name: 'MyCircleView',\r\n    components: {\r\n      CircleSidebar,\r\n      CreatePostForm,\r\n      PostList,\r\n      AddMemberForm\r\n    },\r\n    data() {\r\n      return {\r\n        showAddMemberDialog: false,\r\n        page: 1,\r\n        pageSize: 10\r\n      }\r\n    },\r\n    computed: {\r\n      ...mapState('circles', ['circle', 'members', 'loading']),\r\n      ...mapState('posts', ['posts']),\r\n      ...mapGetters('auth', ['isMentor', 'currentUser']),\r\n      isMember() {\r\n        return this.members.some(m => m.id === this.currentUser.id)\r\n      }\r\n    },\r\n    async created() {\r\n      await this.fetchCircleData()\r\n    },\r\n    methods: {\r\n      ...mapActions('circles', ['fetchMyCircle']),\r\n      ...mapActions('posts', ['fetchCirclePosts']),\r\n      async fetchCircleData() {\r\n        await this.fetchMyCircle()\r\n        if (this.circle?.id) {\r\n          await this.fetchCirclePosts({\r\n            circleId: this.circle.id,\r\n            page: this.page,\r\n            pageSize: this.pageSize\r\n          })\r\n        }\r\n      },\r\n      handlePostCreated(newPost) {\r\n        this.posts.unshift(newPost)\r\n      },\r\n      handleMemberAdded() {\r\n        this.showAddMemberDialog = false\r\n        this.fetchCircleData()\r\n      },\r\n      async loadMorePosts() {\r\n        this.page++\r\n        await this.fetchCirclePosts({\r\n          circleId: this.circle.id,\r\n          page: this.page,\r\n          pageSize: this.pageSize\r\n        })\r\n      }\r\n    }\r\n  }\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .circle-container {\r\n    padding: 20px;\r\n    max-width: 1200px;\r\n    margin: 0 auto;\r\n  }\r\n  \r\n  .post-area {\r\n    padding: 0 20px;\r\n  }\r\n  </style>"],"mappings":";;AAyCE,SAASA,QAAQ,EAAEC,UAAU,EAAEC,UAAS,QAAS,MAAK;AACtD,OAAOC,aAAY,MAAO,gCAA+B;AACzD,OAAOC,cAAa,MAAO,iCAAgC;AAC3D,OAAOC,QAAO,MAAO,2BAA0B;AAC/C,OAAOC,aAAY,MAAO,gCAA+B;AAEzD,eAAe;EACbC,IAAI,EAAE,cAAc;EACpBC,UAAU,EAAE;IACVL,aAAa;IACbC,cAAc;IACdC,QAAQ;IACRC;EACF,CAAC;EACDG,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,mBAAmB,EAAE,KAAK;MAC1BC,IAAI,EAAE,CAAC;MACPC,QAAQ,EAAE;IACZ;EACF,CAAC;EACDC,QAAQ,EAAE;IACR,GAAGb,QAAQ,CAAC,SAAS,EAAE,CAAC,QAAQ,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;IACxD,GAAGA,QAAQ,CAAC,OAAO,EAAE,CAAC,OAAO,CAAC,CAAC;IAC/B,GAAGC,UAAU,CAAC,MAAM,EAAE,CAAC,UAAU,EAAE,aAAa,CAAC,CAAC;IAClDa,QAAQA,CAAA,EAAG;MACT,OAAO,IAAI,CAACC,OAAO,CAACC,IAAI,CAACC,CAAA,IAAKA,CAAC,CAACC,EAAC,KAAM,IAAI,CAACC,WAAW,CAACD,EAAE;IAC5D;EACF,CAAC;EACD,MAAME,OAAOA,CAAA,EAAG;IACd,MAAM,IAAI,CAACC,eAAe,CAAC;EAC7B,CAAC;EACDC,OAAO,EAAE;IACP,GAAGpB,UAAU,CAAC,SAAS,EAAE,CAAC,eAAe,CAAC,CAAC;IAC3C,GAAGA,UAAU,CAAC,OAAO,EAAE,CAAC,kBAAkB,CAAC,CAAC;IAC5C,MAAMmB,eAAeA,CAAA,EAAG;MACtB,MAAM,IAAI,CAACE,aAAa,CAAC;MACzB,IAAI,IAAI,CAACC,MAAM,EAAEN,EAAE,EAAE;QACnB,MAAM,IAAI,CAACO,gBAAgB,CAAC;UAC1BC,QAAQ,EAAE,IAAI,CAACF,MAAM,CAACN,EAAE;UACxBP,IAAI,EAAE,IAAI,CAACA,IAAI;UACfC,QAAQ,EAAE,IAAI,CAACA;QACjB,CAAC;MACH;IACF,CAAC;IACDe,iBAAiBA,CAACC,OAAO,EAAE;MACzB,IAAI,CAACC,KAAK,CAACC,OAAO,CAACF,OAAO;IAC5B,CAAC;IACDG,iBAAiBA,CAAA,EAAG;MAClB,IAAI,CAACrB,mBAAkB,GAAI,KAAI;MAC/B,IAAI,CAACW,eAAe,CAAC;IACvB,CAAC;IACD,MAAMW,aAAaA,CAAA,EAAG;MACpB,IAAI,CAACrB,IAAI,EAAC;MACV,MAAM,IAAI,CAACc,gBAAgB,CAAC;QAC1BC,QAAQ,EAAE,IAAI,CAACF,MAAM,CAACN,EAAE;QACxBP,IAAI,EAAE,IAAI,CAACA,IAAI;QACfC,QAAQ,EAAE,IAAI,CAACA;MACjB,CAAC;IACH;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}